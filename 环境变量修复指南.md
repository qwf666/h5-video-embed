# ğŸ”§ ç¯å¢ƒå˜é‡ä¿®å¤æŒ‡å—

## é—®é¢˜æè¿°

åœ¨ Vite é¡¹ç›®ä¸­å‡ºç° `process is not defined` é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸º Vite ä¸æ”¯æŒ Node.js çš„ `process.env`ï¼Œéœ€è¦ä½¿ç”¨ `import.meta.env`ã€‚

## âœ… å·²ä¿®å¤çš„é—®é¢˜

### 1. App.jsx ä¸­çš„ç¯å¢ƒå˜é‡å¼•ç”¨

**ä¿®å¤å‰ï¼š**
```javascript
youtubeApiKey={process.env.REACT_APP_YOUTUBE_API_KEY}
```

**ä¿®å¤åï¼š**
```javascript
youtubeApiKey={import.meta.env.VITE_YOUTUBE_API_KEY}
```

## ğŸ”§ Vite ç¯å¢ƒå˜é‡è§„èŒƒ

### 1. ç¯å¢ƒå˜é‡å‰ç¼€

Vite ä¸­çš„ç¯å¢ƒå˜é‡å¿…é¡»ä»¥ `VITE_` å¼€å¤´æ‰èƒ½åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­è®¿é—®ï¼š

```bash
# âœ… æ­£ç¡® - å¯ä»¥åœ¨å‰ç«¯è®¿é—®
VITE_YOUTUBE_API_KEY=your_key_here
VITE_SERVER_URL=http://localhost:3001

# âŒ é”™è¯¯ - æ— æ³•åœ¨å‰ç«¯è®¿é—®
REACT_APP_YOUTUBE_API_KEY=your_key_here
YOUTUBE_API_KEY=your_key_here
```

### 2. è®¿é—®æ–¹å¼

```javascript
// âœ… Vite ä¸­æ­£ç¡®çš„è®¿é—®æ–¹å¼
const apiKey = import.meta.env.VITE_YOUTUBE_API_KEY;
const serverUrl = import.meta.env.VITE_SERVER_URL;
const isDev = import.meta.env.DEV; // Vite å†…ç½®å˜é‡

// âŒ åœ¨ Vite ä¸­ä¸å¯ç”¨
const apiKey = process.env.REACT_APP_YOUTUBE_API_KEY;
const nodeEnv = process.env.NODE_ENV;
```

### 3. å†…ç½®ç¯å¢ƒå˜é‡

Vite æä¾›äº†ä¸€äº›å†…ç½®çš„ç¯å¢ƒå˜é‡ï¼š

```javascript
import.meta.env.MODE          // 'development' æˆ– 'production'
import.meta.env.DEV           // booleanï¼Œå¼€å‘æ¨¡å¼æ—¶ä¸º true
import.meta.env.PROD          // booleanï¼Œç”Ÿäº§æ¨¡å¼æ—¶ä¸º true
import.meta.env.SSR           // booleanï¼ŒæœåŠ¡ç«¯æ¸²æŸ“æ—¶ä¸º true
```

## ğŸ“ ç¯å¢ƒå˜é‡é…ç½®

### 1. åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶

åœ¨ `packages/demo-app/` ç›®å½•ä¸‹åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# .env
VITE_YOUTUBE_API_KEY=your_actual_youtube_api_key_here
VITE_SERVER_URL=http://localhost:3001
VITE_DEV_MODE=true
```

### 2. ä¸åŒç¯å¢ƒçš„é…ç½®

```bash
# .env.development (å¼€å‘ç¯å¢ƒ)
VITE_SERVER_URL=http://localhost:3001
VITE_DEV_MODE=true

# .env.production (ç”Ÿäº§ç¯å¢ƒ)
VITE_SERVER_URL=https://your-api-server.com
VITE_DEV_MODE=false
```

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### 1. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

```jsx
// App.jsx
function App() {
  const youtubeApiKey = import.meta.env.VITE_YOUTUBE_API_KEY;
  const serverUrl = import.meta.env.VITE_SERVER_URL || 'http://localhost:3001';
  
  return (
    <VideoEmbed
      url={videoUrl}
      youtubeApiKey={youtubeApiKey}
      serverUrl={serverUrl}
    />
  );
}
```

### 2. æ¡ä»¶æ¸²æŸ“

```jsx
// å¼€å‘æ¨¡å¼ä¸‹æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
{import.meta.env.DEV && (
  <div className="debug-info">
    <p>å¼€å‘æ¨¡å¼</p>
    <p>APIæœåŠ¡å™¨: {import.meta.env.VITE_SERVER_URL}</p>
  </div>
)}
```

### 3. ç±»å‹å®‰å…¨ï¼ˆTypeScriptï¼‰

å¦‚æœä½¿ç”¨ TypeScriptï¼Œå¯ä»¥æ‰©å±•ç¯å¢ƒå˜é‡ç±»å‹ï¼š

```typescript
// vite-env.d.ts
interface ImportMetaEnv {
  readonly VITE_YOUTUBE_API_KEY: string;
  readonly VITE_SERVER_URL: string;
  readonly VITE_DEV_MODE: string;
}

interface ImportMeta {
  readonly env: ImportMetaEnv;
}
```

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

### 1. æ•æ„Ÿä¿¡æ¯ä¿æŠ¤

```bash
# âœ… å¯ä»¥æš´éœ²çš„é…ç½®
VITE_SERVER_URL=http://localhost:3001
VITE_APP_NAME=H5 Video Embed

# âš ï¸ è°¨æ…æš´éœ²çš„ä¿¡æ¯
VITE_YOUTUBE_API_KEY=your_key  # APIå¯†é’¥ä¼šæš´éœ²åœ¨å®¢æˆ·ç«¯

# âŒ ç»ä¸æš´éœ²çš„æ•æ„Ÿä¿¡æ¯
SECRET_KEY=your_secret         # ä¸ä»¥VITE_å¼€å¤´ï¼Œä¸ä¼šæš´éœ²
DATABASE_PASSWORD=password     # æ•æ„Ÿä¿¡æ¯åº”è¯¥åœ¨åç«¯å¤„ç†
```

### 2. æœ€ä½³å®è·µ

1. **APIå¯†é’¥é™åˆ¶**ï¼šä¸ºå‰ç«¯ä½¿ç”¨çš„APIå¯†é’¥è®¾ç½®åŸŸåå’Œå¼•ç”¨é™åˆ¶
2. **ç¯å¢ƒåˆ†ç¦»**ï¼šä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„APIå¯†é’¥
3. **ç‰ˆæœ¬æ§åˆ¶**ï¼šå°† `.env` æ–‡ä»¶æ·»åŠ åˆ° `.gitignore`

```bash
# .gitignore
.env
.env.local
.env.*.local
```

## ğŸ§ª éªŒè¯ä¿®å¤

### 1. å¯åŠ¨åº”ç”¨

```bash
cd packages/demo-app
npm run dev
```

### 2. æ£€æŸ¥æ§åˆ¶å°

åº”è¯¥ä¸å†å‡ºç° `process is not defined` é”™è¯¯ã€‚

### 3. æµ‹è¯•ç¯å¢ƒå˜é‡

åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­è¾“å…¥ï¼š

```javascript
console.log(import.meta.env);
```

åº”è¯¥èƒ½çœ‹åˆ°æ‰€æœ‰ä»¥ `VITE_` å¼€å¤´çš„ç¯å¢ƒå˜é‡ã€‚

## ğŸ”„ è¿ç§»æ¸…å•

å¦‚æœä» Create React App è¿ç§»åˆ° Viteï¼Œéœ€è¦ï¼š

- [ ] å°† `REACT_APP_*` é‡å‘½åä¸º `VITE_*`
- [ ] å°† `process.env.*` æ›¿æ¢ä¸º `import.meta.env.*`
- [ ] æ›´æ–°ç¯å¢ƒå˜é‡æ–‡ä»¶
- [ ] æµ‹è¯•æ‰€æœ‰ä½¿ç”¨ç¯å¢ƒå˜é‡çš„åŠŸèƒ½

## âœ… ä¿®å¤å®Œæˆ

ç°åœ¨ç¯å¢ƒå˜é‡é—®é¢˜å·²ç»ä¿®å¤ï¼Œåº”ç”¨åº”è¯¥å¯ä»¥æ­£å¸¸è¿è¡Œäº†ï¼ğŸ‰
